<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Math & Writing Tutor - Kristina's Academic Success</title>
    <meta name="description" content="AI-powered tutoring for MAT 143 and ENG 111 - get instant help with math problems, writing assignments, and study strategies.">
    
    <!-- Favicon -->
    <link rel="icon" type="image/x-icon" href="/public/favicons/favicon.ico">
    <link rel="icon" type="image/png" sizes="32x32" href="/public/favicons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/public/favicons/favicon-16x16.png">
    
    <!-- Enhanced Design System with Semantic Tokens -->
    <link rel="stylesheet" href="src/styles/globals.css">
    
    <!-- Lucide Icons -->
    <script src="https://unpkg.com/lucide@latest/dist/umd/lucide.js"></script>
</head>
<body class="bg-[var(--color-background-default)] text-[var(--color-text-primary)] font-['Host_Grotesk'] min-h-screen">
    <!-- Enhanced Responsive Header -->
    <header class="bg-[var(--color-background-default)] border-b border-[var(--color-border-secondary)] shadow-sm sticky top-0 z-50">
        <div class="container mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex items-center justify-between h-16">
                <div class="flex items-center space-x-4">
                    <a href="index.html" class="flex items-center space-x-3 text-[var(--color-text-primary)] hover:text-[var(--color-text-brand-primary)] transition-colors focus:outline-none focus:ring-2 focus:ring-[var(--color-brand-default)] focus:ring-offset-2 rounded-lg px-2 py-1" aria-label="Back to Dashboard">
                        <i data-lucide="arrow-left" aria-hidden="true" class="w-5 h-5"></i>
                        <span class="text-lg font-medium hidden sm:inline">Back to Dashboard</span>
                        <span class="text-lg font-medium sm:hidden">Back</span>
                    </a>
                </div>
                <div class="flex items-center space-x-3">
                    <div class="w-10 h-10 bg-[var(--color-brand-default)] rounded-lg flex items-center justify-center">
                        <i data-lucide="brain-circuit" aria-hidden="true" class="w-5 h-5 text-white"></i>
                    </div>
                    <div>
                        <h1 class="text-lg sm:text-xl font-medium text-[var(--color-text-primary)]">AI Tutor</h1>
                        <p class="text-sm text-[var(--color-text-secondary)]">MAT 143 & ENG 111 Helper</p>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <main class="container mx-auto px-4 sm:px-6 lg:px-8 py-6 sm:py-8 max-w-6xl">
        <!-- Subject Selection -->
        <section class="mb-6 sm:mb-8" aria-labelledby="subject-heading">
            <h2 id="subject-heading" class="text-xl sm:text-2xl font-medium text-[var(--color-text-primary)] mb-6">Choose Your Subject</h2>
            <div class="flex flex-col sm:flex-row gap-4">
                <button id="math-btn" class="adhd-button adhd-button-primary flex-1" aria-pressed="true" aria-label="Select Math tutoring">
                    <i data-lucide="calculator" class="w-5 h-5" aria-hidden="true"></i>
                    <span>Math (MAT 143)</span>
                </button>
                <button id="english-btn" class="adhd-button adhd-button-secondary flex-1" aria-pressed="false" aria-label="Select English tutoring">
                    <i data-lucide="pen-tool" class="w-5 h-5" aria-hidden="true"></i>
                    <span>English (ENG 111)</span>
                </button>
            </div>
        </section>

        <!-- Quick Actions -->
        <section class="mb-6 sm:mb-8" aria-labelledby="quick-actions-heading">
            <h2 id="quick-actions-heading" class="text-xl sm:text-2xl font-medium text-[var(--color-text-primary)] mb-6">🚀 Quick Help</h2>
            <div class="responsive-grid">
                <button class="adhd-card quick-action cursor-pointer" data-prompt="Show me the most important formulas for my next test" aria-label="Get test formulas">
                    <div class="flex items-center space-x-3">
                        <div class="w-8 h-8 bg-[var(--color-brand-default)] rounded-lg flex items-center justify-center" aria-hidden="true">
                            <i data-lucide="clipboard-check" class="w-4 h-4 text-white"></i>
                        </div>
                        <div>
                            <h3 class="text-lg font-medium text-[var(--color-text-primary)]">Test Formulas</h3>
                            <p class="text-sm text-[var(--color-text-secondary)]">Get key formulas for your next test</p>
                        </div>
                    </div>
                </button>

                <button class="adhd-card quick-action cursor-pointer" data-prompt="Help me review the key concepts from this chapter" aria-label="Review chapter concepts">
                    <div class="flex items-center space-x-3">
                        <div class="w-8 h-8 bg-[var(--color-brand-default)] rounded-lg flex items-center justify-center" aria-hidden="true">
                            <i data-lucide="book-open" class="w-4 h-4 text-white"></i>
                        </div>
                        <div>
                            <h3 class="text-lg font-medium text-[var(--color-text-primary)]">Chapter Review</h3>
                            <p class="text-sm text-[var(--color-text-secondary)]">Review key concepts and topics</p>
                        </div>
                    </div>
                </button>

                <button class="adhd-button adhd-button-secondary quick-action cursor-pointer" data-prompt="Help me improve my essay writing skills" aria-label="Get writing help">
                    <i data-lucide="edit" class="w-4 h-4" aria-hidden="true"></i>
                    <span>Writing Help</span>
                </button>
            </div>
        </section>

        <!-- Chat Interface -->
        <section class="mb-6 sm:mb-8" aria-labelledby="chat-heading">
            <h2 id="chat-heading" class="text-xl sm:text-2xl font-medium text-[var(--color-text-primary)] mb-6">💬 Ask Your Tutor</h2>
            <div class="adhd-card">
                <!-- Chat Messages -->
                <div id="chat-messages" class="h-96 overflow-y-auto mb-4 p-4 bg-[var(--color-background-secondary)] rounded-lg" role="log" aria-live="polite" aria-label="Chat conversation">
                    <div class="flex items-start space-x-3 mb-4">
                        <div class="w-8 h-8 rounded-full bg-[var(--color-brand-default)] flex items-center justify-center flex-shrink-0" aria-hidden="true">
                            <i data-lucide="brain-circuit" class="w-4 h-4 text-white"></i>
                        </div>
                        <div>
                            <p class="text-[var(--color-text-primary)]">Hi Kristina! I'm your AI tutor. I can help you with:</p>
                            <ul class="text-sm text-[var(--color-text-secondary)] mt-2 space-y-1">
                                <li>• Math problems and formulas</li>
                                <li>• Essay writing and organization</li>
                                <li>• Study strategies and test prep</li>
                                <li>• Homework help and explanations</li>
                            </ul>
                            <p class="text-sm text-[var(--color-text-secondary)] mt-2">What would you like help with today?</p>
                        </div>
                    </div>
                </div>

                <!-- Input Area -->
                <div class="flex space-x-3">
                    <input 
                        type="text" 
                        id="user-input" 
                        placeholder="Ask me anything about math or writing..."
                        class="flex-1 px-4 py-3 border border-[var(--color-border-secondary)] rounded-lg bg-[var(--color-background-default)] text-[var(--color-text-primary)] placeholder:text-[var(--color-text-muted)] focus:outline-none focus:ring-2 focus:ring-[var(--color-brand-default)] focus:ring-offset-2"
                        aria-label="Type your question here"
                    >
                    <button 
                        id="send-btn" 
                        class="adhd-button adhd-button-primary"
                        aria-label="Send message"
                    >
                        <i data-lucide="send" class="w-4 h-4" aria-hidden="true"></i>
                        <span class="hidden sm:inline">Send</span>
                    </button>
                </div>
            </div>
        </section>

        <!-- Course Materials Quick Access -->
        <section class="mb-6 sm:mb-8" aria-labelledby="materials-heading">
            <h2 id="materials-heading" class="text-xl sm:text-2xl font-medium text-[var(--color-text-primary)] mb-6">📚 Course Materials</h2>
            <div class="responsive-grid">
                <!-- Math Materials -->
                <div class="adhd-card" role="article" aria-labelledby="math-materials">
                    <div class="flex items-center space-x-3 mb-4">
                        <div class="w-8 h-8 bg-[var(--color-brand-default)] rounded-lg flex items-center justify-center" aria-hidden="true">
                            <i data-lucide="calculator" class="w-4 h-4 text-white"></i>
                        </div>
                        <h3 id="math-materials" class="text-lg font-medium text-[var(--color-text-primary)]">Math Resources</h3>
                    </div>
                    <div class="space-y-2">
                        <a href="formula_lookup.html" class="block p-3 bg-[var(--color-background-secondary)] rounded-lg hover:bg-[var(--color-background-tertiary)] transition-colors" aria-label="View formula lookup">
                            <div class="flex items-center space-x-3">
                                <i data-lucide="search" class="w-4 h-4 text-[var(--color-brand-default)]" aria-hidden="true"></i>
                                <span class="text-sm text-[var(--color-text-secondary)]">Formula Lookup</span>
                            </div>
                        </a>
                        <a href="chapter-1.html" class="block p-3 bg-[var(--color-background-secondary)] rounded-lg hover:bg-[var(--color-background-tertiary)] transition-colors" aria-label="View Chapter 1">
                            <div class="flex items-center space-x-3">
                                <i data-lucide="book" class="w-4 h-4 text-[var(--color-brand-default)]" aria-hidden="true"></i>
                                <span class="text-sm text-[var(--color-text-secondary)]">Chapter 1: Thinking Mathematically</span>
                            </div>
                        </a>
                        <a href="chapter-4.html" class="block p-3 bg-[var(--color-background-secondary)] rounded-lg hover:bg-[var(--color-background-tertiary)] transition-colors" aria-label="View Chapter 4">
                            <div class="flex items-center space-x-3">
                                <i data-lucide="book" class="w-4 h-4 text-[var(--color-brand-default)]" aria-hidden="true"></i>
                                <span class="text-sm text-[var(--color-text-secondary)]">Chapter 4: Proportions & Percentages</span>
                            </div>
                        </a>
                    </div>
                </div>

                <!-- English Materials -->
                <div class="adhd-card" role="article" aria-labelledby="english-materials">
                    <div class="flex items-center space-x-3 mb-4">
                        <div class="w-8 h-8 bg-[var(--color-brand-default)] rounded-lg flex items-center justify-center" aria-hidden="true">
                            <i data-lucide="pen-tool" class="w-4 h-4 text-white"></i>
                        </div>
                        <h3 id="english-materials" class="text-lg font-medium text-[var(--color-text-primary)]">Writing Resources</h3>
                    </div>
                    <div class="space-y-2">
                        <a href="english_materials.html" class="block p-3 bg-[var(--color-background-secondary)] rounded-lg hover:bg-[var(--color-background-tertiary)] transition-colors" aria-label="View English materials">
                            <div class="flex items-center space-x-3">
                                <i data-lucide="file-text" class="w-4 h-4 text-[var(--color-brand-default)]" aria-hidden="true"></i>
                                <span class="text-sm text-[var(--color-text-secondary)]">Essay Writing Guides</span>
                            </div>
                        </a>
                        <a href="english_materials.html#organization" class="block p-3 bg-[var(--color-background-secondary)] rounded-lg hover:bg-[var(--color-background-tertiary)] transition-colors" aria-label="View essay organization">
                            <div class="flex items-center space-x-3">
                                <i data-lucide="layout" class="w-4 h-4 text-[var(--color-brand-default)]" aria-hidden="true"></i>
                                <span class="text-sm text-[var(--color-text-secondary)]">Essay Organization</span>
                            </div>
                        </a>
                        <a href="english_materials.html#topics" class="block p-3 bg-[var(--color-background-secondary)] rounded-lg hover:bg-[var(--color-background-tertiary)] transition-colors" aria-label="View essay topics">
                            <div class="flex items-center space-x-3">
                                <i data-lucide="lightbulb" class="w-4 h-4 text-[var(--color-brand-default)]" aria-hidden="true"></i>
                                <span class="text-sm text-[var(--color-text-secondary)]">Essay Topics</span>
                            </div>
                        </a>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <!-- Initialize Icons and JavaScript -->
    <script>
        // Initialize Lucide icons
        lucide.createIcons();

        // DOM elements
        const mathBtn = document.getElementById('math-btn');
        const englishBtn = document.getElementById('english-btn');
        const userInput = document.getElementById('user-input');
        const sendBtn = document.getElementById('send-btn');
        const chatMessages = document.getElementById('chat-messages');
        const quickActions = document.querySelectorAll('.quick-action');

        let currentSubject = 'math';

        // Subject switching
        mathBtn.addEventListener('click', () => {
            currentSubject = 'math';
            mathBtn.classList.remove('adhd-button-secondary');
            mathBtn.classList.add('adhd-button-primary');
            mathBtn.setAttribute('aria-pressed', 'true');
            englishBtn.classList.remove('adhd-button-primary');
            englishBtn.classList.add('adhd-button-secondary');
            englishBtn.setAttribute('aria-pressed', 'false');
            showSubjectWelcome('math');
        });

        englishBtn.addEventListener('click', () => {
            currentSubject = 'english';
            englishBtn.classList.remove('adhd-button-secondary');
            englishBtn.classList.add('adhd-button-primary');
            englishBtn.setAttribute('aria-pressed', 'true');
            mathBtn.classList.remove('adhd-button-primary');
            mathBtn.classList.add('adhd-button-secondary');
            mathBtn.setAttribute('aria-pressed', 'false');
            showSubjectWelcome('english');
        });

        function showSubjectWelcome(subject) {
            const welcomeMessages = {
                math: {
                    title: "Math Tutor Ready! 📊",
                    content: "I'm here to help with MAT 143! I can assist with:",
                    topics: [
                        "• Problem solving and estimation",
                        "• Proportions and percentages", 
                        "• Linear and exponential functions",
                        "• Personal finance calculations",
                        "• Probability and statistics",
                        "• Measurement and conversions"
                    ]
                },
                english: {
                    title: "Writing Coach Ready! ✍️",
                    content: "I'm here to help with ENG 111! I can assist with:",
                    topics: [
                        "• Essay organization and structure",
                        "• Thesis development and arguments",
                        "• Citation and research methods",
                        "• Grammar and style improvements",
                        "• Compare/contrast essays",
                        "• Cause/effect analysis"
                    ]
                }
            };

            const welcome = welcomeMessages[subject];
            addMessage('ai', `${welcome.title}<br><br>${welcome.content}<br><ul class="mt-2 space-y-1">${welcome.topics.join('')}</ul>`);
        }

        function addMessage(sender, content) {
            const messageDiv = document.createElement('div');
            messageDiv.className = `flex items-start space-x-3 mb-4 ${sender === 'user' ? 'flex-row-reverse' : ''}`;
            
            if (sender === 'user') {
                messageDiv.innerHTML = `
                    <div class="w-8 h-8 rounded-full bg-[var(--color-brand-default)] flex items-center justify-center flex-shrink-0" aria-hidden="true">
                        <i data-lucide="user" class="w-4 h-4 text-white"></i>
                    </div>
                    <div class="bg-[var(--color-brand-default)] rounded-lg p-4 max-w-xs">
                        <p class="text-white">${content}</p>
                    </div>
                `;
            } else {
                messageDiv.innerHTML = `
                    <div class="w-8 h-8 rounded-full bg-[var(--color-brand-default)] flex items-center justify-center flex-shrink-0" aria-hidden="true">
                        <i data-lucide="brain-circuit" class="w-4 h-4 text-white"></i>
                    </div>
                    <div class="bg-[var(--color-background-default)] border border-[var(--color-border-secondary)] rounded-lg p-4 max-w-2xl">
                        <div class="text-[var(--color-text-primary)]">${content}</div>
                    </div>
                `;
            }
            
            chatMessages.appendChild(messageDiv);
            chatMessages.scrollTop = chatMessages.scrollHeight;
            lucide.createIcons();
        }

        async function sendMessage() {
            const message = userInput.value.trim();
            if (!message) return;

            addMessage('user', message);
            userInput.value = '';
            
            sendBtn.disabled = true;
            sendBtn.innerHTML = '<i data-lucide="loader-2" class="w-4 h-4 animate-spin"></i>';
            lucide.createIcons();

            try {
                // Simulate AI response with course-specific help
                const response = await getTutorResponse(message, currentSubject);
                addMessage('ai', response);
                
            } catch (error) {
                console.error('Error:', error);
                addMessage('ai', 'Sorry, I\'m having trouble connecting right now. Please try again in a moment.');
            } finally {
                sendBtn.disabled = false;
                sendBtn.innerHTML = '<i data-lucide="send" class="w-4 h-4"></i><span class="hidden sm:inline">Send</span>';
                lucide.createIcons();
            }
        }

        async function getTutorResponse(question, subject) {
            // Simulate AI response based on course materials
            const responses = {
                math: {
                    formulas: "Here are the key formulas for MAT 143:<br><br><strong>Simple Interest:</strong> I = Prt<br><strong>Compound Interest:</strong> A = P(1 + r/n)^(nt)<br><strong>Linear Functions:</strong> y = mx + b<br><strong>Exponential Functions:</strong> y = a(b)ˣ<br><br>Which specific formula would you like me to explain?",
                    test: "For your next test, focus on these key areas:<br><br>• <strong>Chapter 4:</strong> Proportions, percentages, and rates<br>• <strong>Chapter 5:</strong> Linear and exponential functions<br>• <strong>Practice problems:</strong> Work through sample problems in each section<br>• <strong>Formulas:</strong> Memorize the key formulas and when to use them<br><br>Would you like me to help you practice specific problems?",
                    homework: "I can help you with your homework! Please share the specific problem or concept you're working on, and I'll walk you through it step by step.",
                    default: "I'm here to help with MAT 143! I can assist with formulas, problem-solving, test prep, and homework. What specific topic or problem are you working on?"
                },
                english: {
                    essay: "Here's how to structure your essay:<br><br><strong>Introduction:</strong> Hook, background, thesis statement<br><strong>Body Paragraphs:</strong> Topic sentence, evidence, analysis<br><strong>Conclusion:</strong> Restate thesis, summarize main points<br><br>What type of essay are you writing? Compare/contrast, cause/effect, or argument?",
                    writing: "To improve your writing:<br><br>• <strong>Start with an outline</strong> - organize your ideas first<br>• <strong>Use specific examples</strong> - support your arguments with evidence<br>• <strong>Write in short bursts</strong> - 15-25 minute sessions work best<br>• <strong>Revise separately</strong> - don't edit while you write<br><br>What specific writing challenge are you facing?",
                    default: "I'm here to help with ENG 111! I can assist with essay structure, thesis development, citations, and writing techniques. What would you like help with?"
                }
            };

            const subjectResponses = responses[subject];
            const lowerQuestion = question.toLowerCase();
            
            if (lowerQuestion.includes('formula') || lowerQuestion.includes('calculate')) {
                return subjectResponses.formulas;
            } else if (lowerQuestion.includes('test') || lowerQuestion.includes('exam')) {
                return subjectResponses.test;
            } else if (lowerQuestion.includes('homework') || lowerQuestion.includes('problem')) {
                return subjectResponses.homework;
            } else if (lowerQuestion.includes('essay') || lowerQuestion.includes('write')) {
                return subjectResponses.essay;
            } else if (lowerQuestion.includes('writing') || lowerQuestion.includes('improve')) {
                return subjectResponses.writing;
            } else {
                return subjectResponses.default;
            }
        }

        // Event listeners
        sendBtn.addEventListener('click', sendMessage);
        userInput.addEventListener('keypress', (e) => {
            if (e.key === 'Enter') {
                sendMessage();
            }
        });

        // Quick action handlers
        quickActions.forEach(btn => {
            btn.addEventListener('click', () => {
                const prompt = btn.getAttribute('data-prompt');
                if (prompt) {
                    userInput.value = prompt;
                    sendMessage();
                }
            });
        });

        // Initialize with math welcome
        showSubjectWelcome('math');
    </script>
</body>
</html>
